<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='//fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css"/>
    
    <!-- Necessary includes for LocusZoom library -->
    <script src="locuszoom.vendor.min.js" type="text/javascript"></script>
    <script src="locuszoom.app.js" type="text/javascript"></script>
    <link rel="stylesheet" href="locuszoom.css" type="text/css"/>
    
    <title>LocusZoom.js</title>
  </head>

  <body style="background-color: #FAFAFA; margin-left: 20px; margin-right: 20px;">
    <div class="container">

      <div class="row">
        <h1 style="margin-top: 1em;"><strong>Locuszoom.js</strong></h1>
        <h5 style="color: #777">A Javascript/d3 embeddable plugin for interactively visualizing and navigating statistical genetic data from customizable sources.</h5>
      </div>

      <hr>

      <h3>Try LocusZoom.js</h3>
      <p>Shown here is a standard interactive LocusZoom plot, depicting GWAS association data with gene tracks loaded from a University of Michigan API. Change the region of the genome in view by <b>scrolling to zoom</b> or <b>dragging to pan</b>, or use some of the links below to jump to top hits for this study by gene. Click around and experiment... LocusZoom.js can do a lot.</p>
      <div class="row">
        <div class="two columns">
          <h4>Top Hits</h4>
          <style>ul.top_hits li { margin-bottom: 0rem; }</style>
          <ul class="top_hits" style="padding-left: 0.2rem; min-width: 110px;">
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('16:53819169');">FTO</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('9:22051670');">CDKN2A/B</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('7:28196413');">JAZF1</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('19:33909710');">PEPD</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('19:46158513');">GIPR</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('12:71433293');">TSPAN8</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('10:114758349');">TCF7L2</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('8:95937502');">TP53INP1</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('2:27741237');">GCKR</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('6:20679709');">CDKAL1</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('2:161346447');">RBMS1</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('16:75247245');">BCAR1</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('15:77832762');">HMG20A</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('7:15052860');">DGKB</a></li>
            <li><a href="javascript:void(0);" onclick="javascript:jumpTo('5:76427311');">ZBED3</a></li>
          </ul>
        </div>
        <div class="ten columns">
          <div id="plot" class="lz-container-responsive" data-region="10:114550452-115067678"></div>
        </div>
      </div>

      <hr>

      <div class="row">
        <div class="twelve columns">
          
          <h3>Get LocusZoom.js</h3>
          
          <h5>Download Full Source (Latest Version)</h5>
          <p>The links below will lead to the full source for the current version of LocusZoom. If you're looking to just plug LocusZoom in somewhere and are not interested in building/developing on the core, see <a href="#builds">Builds for Inclusion in Web Applications</a>.</p>
          <div>
            <a class="button lz-dashboard-button-yellow" href="https://github.com/statgen/locuszoom/zipball/master"><span>Download .zip</span></a>
            <a class="button lz-dashboard-button-yellow" href="https://github.com/statgen/locuszoom/tarball/master"><span>Download .tar.gz</span></a>
            <a class="button lz-dashboard-button-green" href="https://github.com/statgen/locuszoom" id="view-on-github"><span>View on GitHub</span></a>
          </div>
          
          <br>
          
          <a name="builds"></a><h5>Builds for Inclusion in Web Applications</h5>
          <p>To use LocusZoom in your application you will need <i>both</i> LocusZoom's compiled JavaScript and CSS.</p>
          <h6><strong>Current stable release: <a href="https://github.com/statgen/locuszoom/releases/tag/v0.5.0">v0.5.0</a></strong></h6>
          <div class="row">
            <div class="three columns">
              <strong>JavaScript (uncompressed)</strong>
            </div>
            <div class="nine columns">
              <tt><a href="https://statgen.github.io/locuszoom/versions/0.5.0/locuszoom.app.js">https://statgen.github.io/locuszoom/versions/0.5.0/locuszoom.app.js</a></tt>
            </div>
          </div>
          <div class="row">
            <div class="three columns">
              <strong>JavaScript (minified)</strong>
            </div>
            <div class="nine columns">
              <tt><a href="https://statgen.github.io/locuszoom/versions/0.5.0/locuszoom.app.min.js">https://statgen.github.io/locuszoom/versions/0.5.0/locuszoom.app.min.js</a></tt>
            </div>
          </div>
          <div class="row">
            <div class="three columns">
              <strong>CSS</strong>
            </div>
            <div class="nine columns">
              <tt><a href="https://statgen.github.io/locuszoom/versions/0.5.0/locuszoom.css">https://statgen.github.io/locuszoom/versions/0.5.0/locuszoom.css</a></tt>
            </div>
          </div>
          <br>
          <p>LocusZoom also requires two third-party JavaScript libraries to work: <a href="https://github.com/d3/d3">d3</a> and <a href="https://github.com/kriskowal/Q">Q</a>. Download/link to these individually or download/link to this minified vendor file to get correct versions of both dependencies: <tt><a href="https://statgen.github.io/locuszoom/locuszoom.vendor.min.js">https://statgen.github.io/locuszoom/locuszoom.vendor.min.js</a></tt></p>
          <h6><strong>Past releases</strong></h6>
          <p>Detail of all available past releases can be seen <a href="https://github.com/statgen/locuszoom/releases">here</a>. Use the following URL format to download or link to specific releases via this site:</p>
          <div class="row">
            <div class="three columns">
              <strong>JavaScript (uncompressed)</strong>
            </div>
            <div class="nine columns">
              <tt>https://statgen.github.io/locuszoom/versions/<strong>{VERSION_NUMBER}</strong>/locuszoom.app.js</tt>
            </div>
          </div>
          <div class="row">
            <div class="three columns">
              <strong>JavaScript (minified)</strong>
            </div>
            <div class="nine columns">
              <tt>https://statgen.github.io/locuszoom/versions/<strong>{VERSION_NUMBER}</strong>/locuszoom.app.min.js</tt>
            </div>
          </div>
          <div class="row">
            <div class="three columns">
              <strong>CSS</strong>
            </div>
            <div class="nine columns">
              <tt>https://statgen.github.io/locuszoom/versions/<strong>{VERSION_NUMBER}</strong>/locuszoom.css</tt>
            </div>
          </div>        
        </div>
      </div>

      <hr>

      <div class="row">
        <footer style="text-align: center;">
          &copy; Copyright 2016 <a href="https://github.com/statgen">The University of Michigan Center for Statistical Genetics</a><br>
        </footer>
      </div>

    </div>

    <script type="text/javascript">

    // Determine if we're online
    var online = !(typeof navigator != "undefined" && !navigator.onLine);
    if (window.location.search.indexOf("offline") != -1){ online = false; }
      
    // Define LocusZoom Data Sources object differently depending on online status
    var apiBase, data_sources;
    if (online){
      apiBase = "http://portaldev.sph.umich.edu/api/v1/";
      data_sources = new LocusZoom.DataSources()
        .add("base", ["AssociationLZ", {url: apiBase + "statistic/single/", params: {analysis: 3, id_field: "variant"}}])
        .add("ld", ["LDLZ" ,apiBase + "pair/LD/"])
        .add("gene", ["GeneLZ", { url: apiBase + "annotation/genes/", params: {source: 2} }])
        .add("recomb", ["RecombLZ", { url: apiBase + "annotation/recomb/results/", params: {source: 15} }])
        .add("constraint", ["GeneConstraintLZ", { url: "http://exac.broadinstitute.org/api/constraint" }])
        .add("sig", ["StaticJSON", [{ "x": 0, "y": 4.522 }, { "x": 2881033286, "y": 4.522 }] ])
    } else {
      apiBase = window.location.origin + window.location.pathname.substr(0, window.location.pathname.length - "demo.html".length) + "staticdata/";
      data_sources = new LocusZoom.DataSources()
        .add("base", ["AssociationLZ", {url: apiBase + "assoc_10_114550452-115067678.json?", params: {analysis: 3, id_field: "variant"}}])
        .add("ld", ["LDLZ", { url: apiBase + "ld_10_114550452-115067678.json?" }])
        .add("gene", ["GeneLZ", { url: apiBase + "genes_10_114550452-115067678.json?" }])
        .add("recomb", ["RecombLZ", { url: apiBase + "recomb_10_114550452-115067678.json?" }])
        .add("constraint", ["GeneConstraintLZ", {  url: apiBase + "constraint_10_114550452-115067678.json?" }])
        .add("sig", ["StaticJSON", [{ "x": 0, "y": 7.30103 }, { "x": 2881033286, "y": 7.30103 }] ])
    }

    var mods = { style: { border: "1px dotted #AAA" }};
    layout = LocusZoom.Layouts.get("plot", "standard_association", mods);

    // Populate the div with a LocusZoom plot using the default layout
    var plot = LocusZoom.populate("#plot", data_sources, layout);

    // Add a basic loader to each panel (one that shows when data is requested and hides when one rendering)
    plot.layout.panels.forEach(function(panel){
      plot.panels[panel.id].addBasicLoader();
    });

    /**********************************************************************************
     All of the following code sets up an example form with top hit buttons to jump to
     different regions in the plot, as an example of some ways to build an app around
     a single LocusZoom plot.
    **********************************************************************************/

    var topHits = [
      ["16:53819169", "FTO"],
      ["9:22051670", "CDKN2A/B"],
      ["7:28196413", "JAZF1"],
      ["19:33909710", "PEPD"],
      ["19:46158513", "GIPR"],
      ["12:71433293", "TSPAN8/LGR5"],
      ["10:114758349", "TCF7L2"],
      ["8:95937502", "TP53INP1"],
      ["2:27741237", "GCKR"],
      ["6:20679709", "CDKAL1"],
      ["2:161346447", "RBMS1"],
      ["16:75247245", "BCAR1"],
      ["15:77832762", "HMG20A"],
      ["7:15052860", "DGKB"],
      ["5:76427311", "ZBED3"]
    ];

    function jumpTo(region) {
      var target = region.split(":");
      var chr = target[0];
      var pos = target[1];
      var start = 0;
      var end = 0;
      if (!pos.match(/[-+]/)) {
        start = +pos - 300000
        end = +pos + 300000
      }
      plot.applyState({ chr: chr, start: start, end: end, ldrefvar: "" });
      return false;
    }

  </script>

    
  </body>
</html>
