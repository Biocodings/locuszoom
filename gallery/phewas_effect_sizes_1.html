<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css"/>
    
    <!-- Necessary includes for LocusZoom.js -->
    <script src="../locuszoom.vendor.min.js" type="text/javascript"></script>
    <script src="../locuszoom.app.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../locuszoom.css" type="text/css"/>
    
    <title>LocusZoom.js ~ PheWAS with Effect Sizes Example (1) ~ Gallery</title>

    <style>
      body {
        background-color: #FAFAFA;
        margin: 0px 20px;
      }
      img {
        max-width: 100%;
        box-sizing: border-box;
      }
    </style>

  </head>

  <body>
    <div class="container">

      <h1 style="margin-top: 1em;"><strong>LocusZoom.js</strong></h1>

      <h3 style="float: left; color: #777">PheWAS with Effect Sizes Example (1)</h3>
      <h6 style="float: right;"><a href="../index.html">&lt; return home</a></h6>

      <hr style="clear: both;">

      <p>This example shows one approach to visualizing Phenome-Wide Association Study (PheWAS) results when effect size is known. Data is randomly generated. Phenotypes are listed vertically along the y2-axis with effect size plotted along the x-axis. P-values are used to color points on the plot using an interpolated sequential color scale.<p>

      <div id="plot" class="lz-container-responsive"></div>

      <hr>

      <div class="row">
        <footer style="text-align: center;">
          &copy; Copyright 2016 <a href="https://github.com/statgen">The University of Michigan Center for Statistical Genetics</a><br>
        </footer>
      </div>

      <script type="text/javascript">
        var phewas = [{"phenotype":"Bone cancer","log_pvalue":0.469,"effect_size":-0.033},{"phenotype":"Neurofibromatosis","log_pvalue":0.319,"effect_size":-0.018},{"phenotype":"Hypothyroidism","log_pvalue":0.707,"effect_size":-0.01975},{"phenotype":"Type 1 diabetes","log_pvalue":0.5681,"effect_size":-0.00425},{"phenotype":"Type 2 diabetes","log_pvalue":5.6754,"effect_size":-0.02825},{"phenotype":"Abnormal glucose","log_pvalue":0.545,"effect_size":-0.02225},{"phenotype":"Impaired fasting glucose","log_pvalue":0.5681,"effect_size":0.01},{"phenotype":"Diabetic retinopathy","log_pvalue":0.437,"effect_size":0.02475},{"phenotype":"Hypoglycemia","log_pvalue":0.647,"effect_size":-0.021},{"phenotype":"Adrenal hyperfunction","log_pvalue":0.8561,"effect_size":0.0275},{"phenotype":"Proteinuria","log_pvalue":0.40803,"effect_size":0.0385},{"phenotype":"Hypocalcemia","log_pvalue":0.517,"effect_size":-0.0375},{"phenotype":"Disorders of bilirubin excretion","log_pvalue":0.776,"effect_size":-0.00775},{"phenotype":"Morbid obesity","log_pvalue":1.048,"effect_size":-0.00625},{"phenotype":"Megaloblastic anemia","log_pvalue":2.28,"effect_size":0.032},{"phenotype":"Pancytopenia","log_pvalue":1.178,"effect_size":-0.002},{"phenotype":"Primary thrombocytopenia","log_pvalue":2.231,"effect_size":0.00925},{"phenotype":"Aphasia","log_pvalue":0.829,"effect_size":-0.02175},{"phenotype":"Schizophrenia","log_pvalue":0.814,"effect_size":-0.032},{"phenotype":"Obsessive-compulsive disorders","log_pvalue":9.47,"effect_size":-0.0115},{"phenotype":"Encephalitis","log_pvalue":0.1551,"effect_size":0.007},{"phenotype":"Hypersomnia","log_pvalue":0.864,"effect_size":-0.02625},{"phenotype":"Parkinson's disease","log_pvalue":2.0334,"effect_size":-0.0275},{"phenotype":"Epilepsy","log_pvalue":0.456,"effect_size":-0.01675},{"phenotype":"Complex regional/central pain syndrome","log_pvalue":0.0404,"effect_size":-0.00325},{"phenotype":"Retinal detachments and defects","log_pvalue":0.876,"effect_size":0.00875},{"phenotype":"Fuchs' dystrophy","log_pvalue":17.3972,"effect_size":-0.037},{"phenotype":"Myopia","log_pvalue":0.52,"effect_size":0.0365},{"phenotype":"Scleritis and episcleritis","log_pvalue":1.966,"effect_size":0.021},{"phenotype":"Otosclerosis","log_pvalue":1.274,"effect_size":-0.031},{"phenotype":"Cholesteatoma","log_pvalue":0.616,"effect_size":-0.01575},{"phenotype":"Meniere's disease","log_pvalue":0.424,"effect_size":-0.02075},{"phenotype":"Labyrinthitis","log_pvalue":1.44,"effect_size":0.01},{"phenotype":"Coronary atherosclerosis","log_pvalue":5.444,"effect_size":-0.00025},{"phenotype":"Endocarditis","log_pvalue":2.9893,"effect_size":-0.03475},{"phenotype":"Cardiomyopathy","log_pvalue":1.4141,"effect_size":0.01425},{"phenotype":"Atrial flutter","log_pvalue":0.884,"effect_size":-0.02725}];

        var y2_ticks = [];
        var y_offset = 1;
        phewas.forEach(function(p){
            p.y_offset = y_offset;
            y2_ticks.push({
                y: y_offset,
                text: p.phenotype,
                style: {
                    "font-weight": "bold",
                    "text-anchor": "start"
                }
            });
            y_offset += 1;
        });

        var data_sources = new LocusZoom.DataSources()
        .add("base", ["StaticJSON", phewas])
        .add("zeroline", ["StaticJSON", [{ x: 0, y: 0 }, { x: 0, y: 800 }]]);

        var layout = {
            width: 800,
            height: 800,
            responsive_resize: true,
            panels: [
                {
                    id: "phewas",
                    width: 800,
                    height: 800,
                    proportional_width: 1,
                    margin: { top: 20, right: 220, bottom: 50, left: 20 },
                    inner_border: "rgba(210, 210, 210, 0.85)",
                    axes: {
                        x: {
                            label: "Effect Size",
                            label_offset: 33
                        },
                        y2: {
                            ticks: y2_ticks
                        }
                    },
                    legend: {
                        origin: { x: 30, y: 30 },
                        orientation: "vertical"
                    },
                    data_layers: [
                        {
                            id: "phewaspvalues",
                            type: "scatter",
                            z_index: 1,
                            point_shape: "circle",
                            point_size: 50,
                            color: {
                                scale_function: "interpolate",
                                field: "log_pvalue",
                                parameters: {
                                    breaks: [0, 10],
                                    values: ["#fee8c8","#b30000"],
                                    null_value: "#B8B8B8"
                                }
                            },
                            legend: [
                                { label: "-log p-value" },
                                { shape: "circle", color: "#fdd49e", size: 40, label: "< 2" },
                                { shape: "circle", color: "#fdbb84", size: 40, label: "2 - 4" },
                                { shape: "circle", color: "#fc8d59", size: 40, label: "4 - 6" },
                                { shape: "circle", color: "#ef6548", size: 40, label: "6 - 8" },
                                { shape: "circle", color: "#d7301f", size: 40, label: "8 - 10" },
                                { shape: "circle", color: "#b30000", size: 40, label: "10+" }
                            ],
                            id_field: "phenotype",
                            fields: ["phenotype", "log_pvalue", "log_pvalue|logtoscinotation", "effect_size", "y_offset"],
                            x_axis: {
                                field: "effect_size",
                                floor: -0.2,
                                ceiling: 0.2
                            },
                            y_axis: {
                                axis: 2,
                                field: "y_offset",
                                floor: 0,
                                ceiling: y_offset
                            },
                            highlighted: {
                                onmouseover: "on",
                                onmouseout: "off"
                            },
                            selected: {
                                onclick: "toggle_exclusive",
                                onshiftclick: "toggle"
                            },
                            tooltip: {
                                closable: true,
                                show: { or: ["highlighted", "selected"] },
                                hide: { and: ["unhighlighted", "unselected"] },
                                html: "<strong>{{phenotype}}</strong><br>"
                                    + "P Value: <strong>{{log_pvalue|logtoscinotation}}</strong><br>"
                                    + "Effect Size: <strong>{{effect_size}}</strong>"
                            }
                        },
                        {
                            id: "zeroline",
                            type: "line",
                            z_index: 0,
                            fields: ["zeroline:x", "zeroline:y"],
                            style: {
                                "stroke": "#D3D3D3",
                                "stroke-width": "2px",
                                "stroke-dasharray": "4px 4px"
                            },
                            x_axis: {
                                field: "zeroline:x",
                                decoupled: true
                            },
                            y_axis: {
                                axis: 1,
                                field: "zeroline:y"
                            }
                        }
                    ]
                }
            ]
        };

        var plot = LocusZoom.populate("#plot", data_sources, layout);
        
      </script>

    </div>

  </body>
</html>
